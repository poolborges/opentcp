<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>udp.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.18 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="modules.html">Modules</a> &nbsp; <a class="qindex" href="annotated.html">Data Structures</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Data Fields</a> &nbsp; <a class="qindex" href="globals.html">Globals</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; <a class="qindex" href="examples.html">Examples</a> &nbsp; </center>
<hr><h1>/opentcp/udp.c File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
 <dl compact><dt><b>Author: </b></dt><dd>
 <ul>
<li> Jari Lahti (<a href="mailto:jari.lahti@violasystems.com">jari.lahti@violasystems.com</a>) </ul>
</dl><dl compact><dt><b>Version: </b></dt><dd>
1.0 </dl><dl compact><dt><b>Date: </b></dt><dd>
15.7.2002 </dl><dl compact><dt><b><a class="el" href="bug.html#_bug000024">Bug: </a></b></dt><dd>
</dl> <dl compact><dt><b>Warning: </b></dt><dd>
 </dl><dl compact><dt><b><a class="el" href="todo.html#_todo000026">Todo: </a></b></dt><dd>
<ul>
<li> Send ICMP Destination Unreachable when receiving UDP packets to non-existent UDP ports.</dl></ul>
OpenTCP UDP implementation. All functions necessary for UDP packet processing are present here. Note that only a small subset of these functions must be used for "normal" applications that are using the UDP for communciation. For function declarations and lots of other usefull stuff see <a class="el" href="tcp__ip_8h.html">inet/tcp_ip.h</a>.
<p>
For examples how to use UDP and write applications that communicate using UDP see inet/demo/main_demo.c and inet/demo/udp_demo.c.
<p>

<p>
Definition in file <a class="el" href="udp_8c-source.html">udp.c</a>.
<p>
<a href="udp_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td nowrap align=right valign=top>INT8&nbsp;</td><td valign=bottom><a class="el" href="udp_8c.html#a2">udp_init</a> (void)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Initialize UDP socket pool.</em> <a href="#a2"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>INT8&nbsp;</td><td valign=bottom><a class="el" href="udp_8c.html#a3">udp_getsocket</a> (UINT8 tos, INT32(*listener)(INT8, UINT8, UINT32, UINT16, UINT16, UINT16), UINT8 opts)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Allocate a free socket in UDP socket pool.</em> <a href="#a3"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>INT8&nbsp;</td><td valign=bottom><a class="el" href="udp_8c.html#a4">udp_releasesocket</a> (INT8 sochandle)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Release a given socket.</em> <a href="#a4"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>INT8&nbsp;</td><td valign=bottom><a class="el" href="udp_8c.html#a5">udp_open</a> (INT8 sochandle, UINT16 locport)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Open a given UDP socket for communication.</em> <a href="#a5"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>INT8&nbsp;</td><td valign=bottom><a class="el" href="udp_8c.html#a6">udp_close</a> (INT8 sochandle)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Close given socket for communication.</em> <a href="#a6"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>INT16&nbsp;</td><td valign=bottom><a class="el" href="udp_8c.html#a7">udp_send</a> (INT8 sochandle, UINT32 remip, UINT16 remport, UINT8 *buf, UINT16 blen, UINT16 dlen)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Send data to remote host using given UDP socket.</em> <a href="#a7"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>INT16&nbsp;</td><td valign=bottom><a class="el" href="udp_8c.html#a8">process_udp_in</a> (struct <a class="el" href="structip__frame.html">ip_frame</a> *frame, UINT16 len)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Process received UDP frame.</em> <a href="#a8"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>UINT16&nbsp;</td><td valign=bottom><a class="el" href="udp_8c.html#a9">udp_getfreeport</a> (void)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Returns next free (not used) local port number.</em> <a href="#a9"></a><em></em></font><br><br></td></tr>
<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="structucb.html">ucb</a>&nbsp;</td><td valign=bottom><a class="el" href="udp_8c.html#a0">udp_socket</a> [NO_OF_UDPSOCKETS]</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>UDP table holding socket parameters for every UDP socket.</em> <a href="#a0"></a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="structudp__frame.html">udp_frame</a>&nbsp;</td><td valign=bottom><a class="el" href="udp_8c.html#a1">received_udp_packet</a></td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Used for storing field information about the received UDP packet.</em> <a href="#a1"></a><em></em></font><br><br></td></tr>
</table>
<hr><h2>Function Documentation</h2>
<a name="a2" doxytag="udp.c::udp_init"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> INT8 udp_init </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp;          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Author: </b></dt><dd>
 <ul>
<li> Jari Lahti (<a href="mailto:jari.lahti@violasystems.com">jari.lahti@violasystems.com</a>) </ul>
</dl><dl compact><dt><b>Date: </b></dt><dd>
26.07.2002 </dl><dl compact><dt><b>Returns: </b></dt><dd>
 <ul>
<li> -1 - Error <li> &gt;0 - Number of UDP sockets initialized </ul>
</dl><dl compact><dt><b>Warning: </b></dt><dd>
 <ul>
<li> This function <b>must</b> be invoked before any other UDP-related function is called</ul>
</dl>This function initializes UDP socket pool to get everything into a known state at startup. 
<p>
Definition at line <a class="el" href="udp_8c-source.html#l00118">118</a> of file <a class="el" href="udp_8c-source.html">udp.c</a>.
<p>
References <a class="el" href="tcp__ip_8h-source.html#l00525">ucb::locport</a>, <a class="el" href="tcp__ip_8h-source.html#l00539">ucb::opts</a>, <a class="el" href="tcp__ip_8h-source.html#l00516">ucb::state</a>, <a class="el" href="tcp__ip_8h-source.html#l00523">ucb::tos</a>, <a class="el" href="tcp__ip_8h-source.html#l00140">UDP_OPT_CHECK_CS</a>, <a class="el" href="tcp__ip_8h-source.html#l00132">UDP_OPT_SEND_CS</a>, and <a class="el" href="tcp__ip_8h-source.html#l00249">UDP_STATE_FREE</a>.    </td>
  </tr>
</table>
<a name="a3" doxytag="udp.c::udp_getsocket"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> INT8 udp_getsocket </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">UINT8&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>tos</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>INT32(*&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>listener</em>)(INT8, UINT8, UINT32, UINT16, UINT16, UINT16), </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>UINT8&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>opts</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Author: </b></dt><dd>
 <ul>
<li> Jari Lahti (<a href="mailto:jari.lahti@violasystems.com">jari.lahti@violasystems.com</a>) </ul>
</dl><dl compact><dt><b>Date: </b></dt><dd>
26.07.2002 </dl><dl compact><dt><b>Parameters: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>tos</em>&nbsp;</td><td>
type of service for socket. For now nothing implemented so 0. </td></tr>
<tr><td valign=top><em>listener</em>&nbsp;</td><td>
pointer to callback function that will be invoked by the TCP/IP stack to inform socket application of UDP_DATA_ARRIVAL event (for now only this, in future maybe others!) </td></tr>
<tr><td valign=top><em>opts</em>&nbsp;</td><td>
Options for checksum generation &amp; inspection. Can be one of the following: <ul>
<li> <a class="el" href="tcp__ip_8h.html#a4">UDP_OPT_NONE</a> <li> <a class="el" href="tcp__ip_8h.html#a5">UDP_OPT_SEND_CS</a> <li> <a class="el" href="tcp__ip_8h.html#a6">UDP_OPT_CHECK_CS</a> <li> <a class="el" href="tcp__ip_8h.html#a5">UDP_OPT_SEND_CS</a> | <a class="el" href="tcp__ip_8h.html#a6">UDP_OPT_CHECK_CS</a> </ul>
</td></tr>
</table>
</dl><dl compact><dt><b>Returns: </b></dt><dd>
 <ul>
<li> -1 - Error <li> &gt;=0 - Handle to reserved socket</ul>
</dl>Invoke this function to try to obtain a free socket from UDP socket pool. Function returns a handle to the free socket that is later used for  accessing the allocated socket. 
<p>
Definition at line <a class="el" href="udp_8c-source.html#l00175">175</a> of file <a class="el" href="udp_8c-source.html">udp.c</a>.
<p>
References <a class="el" href="tcp__ip_8h-source.html#l00525">ucb::locport</a>, <a class="el" href="tcp__ip_8h-source.html#l00539">ucb::opts</a>, <a class="el" href="tcp__ip_8h-source.html#l00516">ucb::state</a>, <a class="el" href="tcp__ip_8h-source.html#l00523">ucb::tos</a>, <a class="el" href="tcp__ip_8h-source.html#l00140">UDP_OPT_CHECK_CS</a>, <a class="el" href="tcp__ip_8h-source.html#l00132">UDP_OPT_SEND_CS</a>, <a class="el" href="tcp__ip_8h-source.html#l00258">UDP_STATE_CLOSED</a>, and <a class="el" href="tcp__ip_8h-source.html#l00249">UDP_STATE_FREE</a>.
<p>
Referenced by <a class="el" href="bootp_8c-source.html#l00108">bootpc_init()</a>, <a class="el" href="dhcpc_8c-source.html#l00158">dhcpc_init()</a>, <a class="el" href="dns_8c-source.html#l00108">dns_init()</a>, and <a class="el" href="tftps_8c-source.html#l00136">tftps_init()</a>.    </td>
  </tr>
</table>
<a name="a4" doxytag="udp.c::udp_releasesocket"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> INT8 udp_releasesocket </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">INT8&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>sochandle</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Author: </b></dt><dd>
 <ul>
<li> Jari Lahti (<a href="mailto:jari.lahti@violasystems.com">jari.lahti@violasystems.com</a>) </ul>
</dl><dl compact><dt><b>Date: </b></dt><dd>
26.07.2002 </dl><dl compact><dt><b>Parameters: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>sochandle</em>&nbsp;</td><td>
handle of UDP socket to be released </td></tr>
</table>
</dl><dl compact><dt><b>Returns: </b></dt><dd>
 <ul>
<li> -1 - error <li> &gt;=0 - OK (returns handle to release socket)</ul>
</dl>This function releases UDP socket. This means that the socket entry is marked as free and all of the ucb fields are initialized to default values. 
<p>
Definition at line <a class="el" href="udp_8c-source.html#l00244">244</a> of file <a class="el" href="udp_8c-source.html">udp.c</a>.
<p>
References <a class="el" href="tcp__ip_8h-source.html#l00525">ucb::locport</a>, <a class="el" href="tcp__ip_8h-source.html#l00539">ucb::opts</a>, <a class="el" href="tcp__ip_8h-source.html#l00516">ucb::state</a>, <a class="el" href="tcp__ip_8h-source.html#l00523">ucb::tos</a>, <a class="el" href="tcp__ip_8h-source.html#l00140">UDP_OPT_CHECK_CS</a>, <a class="el" href="tcp__ip_8h-source.html#l00132">UDP_OPT_SEND_CS</a>, and <a class="el" href="tcp__ip_8h-source.html#l00249">UDP_STATE_FREE</a>.    </td>
  </tr>
</table>
<a name="a5" doxytag="udp.c::udp_open"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> INT8 udp_open </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">INT8&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>sochandle</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>UINT16&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>locport</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Author: </b></dt><dd>
 <ul>
<li> Jari Lahti (<a href="mailto:jari.lahti@violasystems.com">jari.lahti@violasystems.com</a>) </ul>
</dl><dl compact><dt><b>Date: </b></dt><dd>
26.07.2002 </dl><dl compact><dt><b>Parameters: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>sochandle</em>&nbsp;</td><td>
handle to socket to be opened </td></tr>
<tr><td valign=top><em>locport</em>&nbsp;</td><td>
local port number </td></tr>
</table>
</dl><dl compact><dt><b>Returns: </b></dt><dd>
 <ul>
<li> -1 - Error <li> &gt;=0 - Handle to opened socket</ul>
</dl>This function binds local port to given UDP socket and opens the socket (virtually) in order to enable communication. 
<p>
Definition at line <a class="el" href="udp_8c-source.html#l00291">291</a> of file <a class="el" href="udp_8c-source.html">udp.c</a>.
<p>
References <a class="el" href="tcp__ip_8h-source.html#l00525">ucb::locport</a>, <a class="el" href="tcp__ip_8h-source.html#l00516">ucb::state</a>, <a class="el" href="udp_8c-source.html#l00684">udp_getfreeport()</a>, and <a class="el" href="tcp__ip_8h-source.html#l00266">UDP_STATE_OPENED</a>.
<p>
Referenced by <a class="el" href="bootp_8c-source.html#l00108">bootpc_init()</a>, <a class="el" href="dhcpc_8c-source.html#l00158">dhcpc_init()</a>, <a class="el" href="dns_8c-source.html#l00108">dns_init()</a>, and <a class="el" href="tftps_8c-source.html#l00136">tftps_init()</a>.    </td>
  </tr>
</table>
<a name="a6" doxytag="udp.c::udp_close"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> INT8 udp_close </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">INT8&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>sochandle</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Author: </b></dt><dd>
 <ul>
<li> Jari Lahti (<a href="mailto:jari.lahti@violasystems.com">jari.lahti@violasystems.com</a>) </ul>
</dl><dl compact><dt><b>Date: </b></dt><dd>
26.07.2002 </dl><dl compact><dt><b>Parameters: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>sochandle</em>&nbsp;</td><td>
handle to socket to be closed </td></tr>
</table>
</dl><dl compact><dt><b>Returns: </b></dt><dd>
 <ul>
<li> -1 - Error <li> &gt;=0 - handle to closed socket</ul>
</dl>Closes a given socket in order to disable further communication over it. 
<p>
Definition at line <a class="el" href="udp_8c-source.html#l00340">340</a> of file <a class="el" href="udp_8c-source.html">udp.c</a>.
<p>
References <a class="el" href="tcp__ip_8h-source.html#l00516">ucb::state</a>, and <a class="el" href="tcp__ip_8h-source.html#l00258">UDP_STATE_CLOSED</a>.    </td>
  </tr>
</table>
<a name="a7" doxytag="udp.c::udp_send"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> INT16 udp_send </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">INT8&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>sochandle</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>UINT32&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>remip</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>UINT16&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>remport</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>UINT8 *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>buf</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>UINT16&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>blen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>UINT16&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>dlen</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Author: </b></dt><dd>
 <ul>
<li> Jari Lahti (<a href="mailto:jari.lahti@violasystems.com">jari.lahti@violasystems.com</a>) </ul>
</dl><dl compact><dt><b>Date: </b></dt><dd>
26.07.2002 </dl><dl compact><dt><b>Parameters: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>sochandle</em>&nbsp;</td><td>
handle to UDP socket to use </td></tr>
<tr><td valign=top><em>remip</em>&nbsp;</td><td>
remote IP address to which data should be sent </td></tr>
<tr><td valign=top><em>remport</em>&nbsp;</td><td>
remote port number to which data should be sent </td></tr>
<tr><td valign=top><em>buf</em>&nbsp;</td><td>
pointer to data buffer (start of user data) </td></tr>
<tr><td valign=top><em>blen</em>&nbsp;</td><td>
buffer length in bytes (without space reserved at the  beginning of buffer for headers) </td></tr>
<tr><td valign=top><em>dlen</em>&nbsp;</td><td>
length of user data to be sent (in bytes) </td></tr>
</table>
</dl><dl compact><dt><b>Returns: </b></dt><dd>
 <ul>
<li> -1 - Error (general error, e.g. parameters) <li> -2 - ARP or lower layer not ready, try again later <li> -3 - Socket closed or invalid local port <li> &gt;0 - OK (number represents number of bytes actually sent)</ul>
</dl><dl compact><dt><b>Warning: </b></dt><dd>
 <ul>
<li> <em>buf</em> parameter is a pointer to data to be sent in  user buffer. But note that there <b>MUST</b> be sufficient free buffer space before that data for UDP header (of <a class="el" href="tcp__ip_8h.html#a8">UDP_HLEN</a> size).</ul>
</dl>Use this function to send data over an already opened UDP socket. 
<p>
Definition at line <a class="el" href="udp_8c-source.html#l00395">395</a> of file <a class="el" href="udp_8c-source.html">udp.c</a>.
<p>
References <a class="el" href="ip_8c-source.html#l00539">ip_checksum()</a>, <a class="el" href="ip_8c-source.html#l00582">ip_checksum_buf()</a>, <a class="el" href="ip_8h-source.html#l00073">IP_UDP</a>, <a class="el" href="tcp__ip_8h-source.html#l00525">ucb::locport</a>, <a class="el" href="tcp__ip_8h-source.html#l00539">ucb::opts</a>, <a class="el" href="ip_8c-source.html#l00300">process_ip_out()</a>, <a class="el" href="tcp__ip_8h-source.html#l00516">ucb::state</a>, <a class="el" href="tcp__ip_8h-source.html#l00523">ucb::tos</a>, <a class="el" href="tcp__ip_8h-source.html#l00144">UDP_HLEN</a>, <a class="el" href="tcp__ip_8h-source.html#l00132">UDP_OPT_SEND_CS</a>, and <a class="el" href="tcp__ip_8h-source.html#l00266">UDP_STATE_OPENED</a>.
<p>
Referenced by <a class="el" href="bootp_8c-source.html#l00183">bootpc_run()</a>, <a class="el" href="dhcpc_8c-source.html#l00389">dhcpc_send_message()</a>, and <a class="el" href="dns_8c-source.html#l00445">get_host_by_name()</a>.    </td>
  </tr>
</table>
<a name="a8" doxytag="udp.c::process_udp_in"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> INT16 process_udp_in </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="structip__frame.html">ip_frame</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>frame</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>UINT16&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>len</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Author: </b></dt><dd>
 <ul>
<li> Jari Lahti (<a href="mailto:jari.lahti@violasystems.com">jari.lahti@violasystems.com</a>) </ul>
</dl><dl compact><dt><b>Date: </b></dt><dd>
15.07.2002 </dl><dl compact><dt><b>Parameters: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>frame</em>&nbsp;</td><td>
pointer to received IP frame structure </td></tr>
<tr><td valign=top><em>len</em>&nbsp;</td><td>
length of data in bytes </td></tr>
</table>
</dl><dl compact><dt><b>Returns: </b></dt><dd>
 <ul>
<li> -1 - Error (packet not UDP, header errror or no socket for it) <li> &gt;0 - Packet OK</ul>
</dl>Invoke this function to process received UDP frames. See <a class="el" href="main__demo_8c.html">main_demo.c</a> for an example on how to accomplish this. 
<p>
Definition at line <a class="el" href="udp_8c-source.html#l00550">550</a> of file <a class="el" href="udp_8c-source.html">udp.c</a>.
<p>
References <a class="el" href="tcp__ip_8h-source.html#l00494">udp_frame::buf_index</a>, <a class="el" href="ip_8h-source.html#l00126">ip_frame::buf_index</a>, <a class="el" href="tcp__ip_8h-source.html#l00493">udp_frame::checksum</a>, <a class="el" href="ip_8h-source.html#l00124">ip_frame::dip</a>, <a class="el" href="tcp__ip_8h-source.html#l00491">udp_frame::dport</a>, <a class="el" href="ip_8c-source.html#l00539">ip_checksum()</a>, <a class="el" href="ip_8h-source.html#l00073">IP_UDP</a>, <a class="el" href="tcp__ip_8h-source.html#l00525">ucb::locport</a>, <a class="el" href="system_8h-source.html#l00270">NETWORK_RECEIVE_INITIALIZE</a>, <a class="el" href="tcp__ip_8h-source.html#l00539">ucb::opts</a>, <a class="el" href="ip_8h-source.html#l00121">ip_frame::protocol</a>, <a class="el" href="system_8h-source.html#l00210">RECEIVE_NETWORK_B</a>, <a class="el" href="ip_8h-source.html#l00123">ip_frame::sip</a>, <a class="el" href="tcp__ip_8h-source.html#l00490">udp_frame::sport</a>, <a class="el" href="tcp__ip_8h-source.html#l00516">ucb::state</a>, <a class="el" href="tcp__ip_8h-source.html#l00492">udp_frame::tlen</a>, <a class="el" href="tcp__ip_8h-source.html#l00276">UDP_EVENT_DATA</a>, <a class="el" href="tcp__ip_8h-source.html#l00144">UDP_HLEN</a>, <a class="el" href="tcp__ip_8h-source.html#l00140">UDP_OPT_CHECK_CS</a>, and <a class="el" href="tcp__ip_8h-source.html#l00266">UDP_STATE_OPENED</a>.    </td>
  </tr>
</table>
<a name="a9" doxytag="udp.c::udp_getfreeport"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UINT16 udp_getfreeport </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp;          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Author: </b></dt><dd>
 <ul>
<li> Jari Lahti (<a href="mailto:jari.lahti@violasystems.com">jari.lahti@violasystems.com</a>) </ul>
</dl><dl compact><dt><b>Date: </b></dt><dd>
19.10.2002 </dl><dl compact><dt><b>Returns: </b></dt><dd>
 <ul>
<li> 0 - no free ports! <li> &gt;0 - free local TCP port number</ul>
</dl>Function attempts to find new local port number that can be used to  establish a connection. 
<p>
Definition at line <a class="el" href="udp_8c-source.html#l00684">684</a> of file <a class="el" href="udp_8c-source.html">udp.c</a>.
<p>
References <a class="el" href="tcp__ip_8h-source.html#l00525">ucb::locport</a>, <a class="el" href="tcp__ip_8h-source.html#l00516">ucb::state</a>, <a class="el" href="tcp__ip_8h-source.html#l00109">UDP_PORTS_END</a>, and <a class="el" href="tcp__ip_8h-source.html#l00258">UDP_STATE_CLOSED</a>.
<p>
Referenced by <a class="el" href="udp_8c-source.html#l00291">udp_open()</a>.    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a name="a0" doxytag="udp.c::udp_socket"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> struct <a class="el" href="structucb.html">ucb</a> udp_socket[NO_OF_UDPSOCKETS]
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
UDP table is an array of ucb structures holding all of the  necessary information about the state, listener, port numbers and other info about the UDP sockets opened. Number of UDP sockets that can be opened at any given time is defined by the NO_OF_UDPSOCKETS and may be changed in order to change the amount of used RAM memory. See ucb definition for more information about the structure itself. 
<p>
Definition at line <a class="el" href="udp_8c-source.html#l00094">94</a> of file <a class="el" href="udp_8c-source.html">udp.c</a>.    </td>
  </tr>
</table>
<a name="a1" doxytag="udp.c::received_udp_packet"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> struct <a class="el" href="structudp__frame.html">udp_frame</a> received_udp_packet
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Various fields from the received UDP packet are stored in this variable. See <a class="el" href="structudp__frame.html">udp_frame</a> definition for struct information. 
<p>
Definition at line <a class="el" href="udp_8c-source.html#l00101">101</a> of file <a class="el" href="udp_8c-source.html">udp.c</a>.    </td>
  </tr>
</table>
<hr><address style="align: right;"><small>Generated on Sun Aug 3 20:33:00 2003 for OpenTCP by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.18 </small></address>
</body>
</html>
